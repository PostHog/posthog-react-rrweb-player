{"version":3,"sources":["../../src/PlayerContext.tsx","../../src/icons.tsx","../../src/PlayPauseOverlay.tsx","../../src/PlayerFrame.tsx","../../src/time.ts","../../src/PlayerController.tsx","../../src/eventIndex.ts","App.tsx","index.tsx"],"names":["PLAYBACK_SPEEDS","NOOP","PlayerContext","createContext","PlayerContextProvider","forwardRef","children","events","onPlayerTimeChange","isBuffering","duration","defaultTime","startTime","endTime","totalTime","replayer","useRef","useState","frame","setFrameRef","wrapper","timer","playing","setPlaying","skipping","setSkipping","currentTime","setCurrentTime","meta","setMeta","useLocalStorageState","speed","setSpeed","play","pause","togglePlayPause","seek","forcePlay","time","Math","setCurrentTimeDebounced","onPlayerTimeChangeDebounced","useDebouncedCallback","maxWait","useEffect","stopTimer","root","skipInactive","triggerFocus","updateTime","currentEvents","eventsToAdd","cancelAnimationFrame","requestAnimationFrame","handleKeyDown","event","toggleFullScreen","i","seekBack","screenfull","value","useMemo","useImperativeHandle","ref","onKeyDown","tabIndex","style","height","width","BaseIcon","onClick","className","IconSeekBack","viewBox","fill","xmlns","d","IconPlay","IconPause","IconFullscreen","PlayPauseOverlay","show","setShow","changeCount","setChangeCount","in","timeout","classNames","onEntered","PlayerFrame","replayDimensionRef","context","useContext","window","windowResize","updatePlayerDimensions","replayDimensions","scale","padZero","num","len","str","threshold","String","formatTime","ms","hour","minute","second","PlayerController","React","placement","overlayInnerStyle","minHeight","overlay","min","max","step","onChange","justifyContent","key","speedToggle","index","fontWeight","EventIndex","getDuration","getPageMetadata","findCurrent","playerTime","getRecordingMetadata","pageChangeEvents","href","baseTime","recordingMetadata","resolution","_filterBy","lastValueKey","this","makeOption","label","location","pathname","RECORDINGS","App","setEvents","recording","setRecording","activeRecording","setActiveRecording","setCurrentPlayerTime","playerRef","a","fetch","response","json","result","fetchRecording","eventIndex","pageEvent","atPageIndex","pageVisitEvents","length","onNext","console","log","onPrevious","slice","timestamp","zIndex","marginTop","options","JSON","stringify","map","current","ReactDOM","render","document","getElementById"],"mappings":"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","file":"static/js/main.4b389415.chunk.js","sourcesContent":["import React, {\n    createContext,\n    forwardRef,\n    RefObject,\n    useEffect,\n    useImperativeHandle,\n    useMemo,\n    useRef,\n    useState\n} from 'react'\nimport { Replayer } from 'rrweb'\nimport { useDebouncedCallback } from 'use-debounce'\nimport screenfull from 'screenfull'\nimport { eventWithTime, playerMetaData } from 'rrweb/typings/types'\nimport useLocalStorageState from 'use-local-storage-state'\n\nconst JUMP_TIME_MS = 8_000\nconst PLAYBACK_SPEEDS = [0.5, 1, 2, 4, 8, 16]\nconst NOOP = () => {}\n\ninterface PlayerContextProps {\n    replayer: RefObject<Replayer>\n    frame: HTMLDivElement | null\n    setFrameRef: (ref: HTMLDivElement | null) => void\n    wrapper: RefObject<HTMLDivElement> | null\n    timer: RefObject<number>\n    skipping: boolean\n    playing: boolean\n    currentTime: number\n    speed: number\n    meta: playerMetaData\n    isBuffering: boolean\n    setSkipping: (val: boolean) => void\n    setPlaying: (val: boolean) => void\n    setCurrentTime: (val: number) => void\n    onPlayerTimeChange: (val: number) => void\n    setSpeed: (val: number) => void\n    setMeta: (val: playerMetaData) => void\n    handleKeyDown: (event: React.KeyboardEvent<HTMLDivElement>) => void\n    toggleFullScreen: () => void\n    play: () => void\n    pause: () => void\n    togglePlayPause: () => void\n    seek: (\n        time: number,\n        { forcePlay }?: { forcePlay?: boolean | undefined }\n    ) => void\n    seekBack: () => void\n    stopTimer: () => void\n    updateTime: () => void\n}\n\nexport const PlayerContext = createContext<PlayerContextProps | null>(null)\n\ninterface PlayerContextProviderProps {\n    children: React.ReactNode\n    events: eventWithTime[]\n    onPlayerTimeChange?: (playerTime: number) => void\n    onPrevious?: () => void // Deprecated\n    onNext?: () => void // Deprecated\n    isBuffering?: boolean\n    duration?: number // in milliseconds\n}\n\nexport interface PlayerRef {\n    replayer: RefObject<Replayer | null>\n    seek: (playerTime: number) => void\n}\n\nexport const PlayerContextProvider = forwardRef<\n    PlayerRef,\n    PlayerContextProviderProps\n>(function PlayerContextProvider(\n    { children, events, onPlayerTimeChange, isBuffering = false, duration = 0 },\n    ref\n) {\n    // Implement player state in shared context\n\n    const defaultTime = {\n        startTime: events?.[0]?.timestamp ?? 0,\n        endTime: (events?.[0]?.timestamp ?? 0) + duration,\n        totalTime: duration\n    }\n\n    const replayer = useRef<Replayer | null>(null)\n    const [frame, setFrameRef] = useState<HTMLDivElement | null>(null) // useState here because this is set on consumer render\n    const wrapper = useRef<HTMLDivElement | null>(null) // useState here because this is set on consumer render\n    const timer = useRef<number | null>(null)\n    const [playing, setPlaying] = useState(true)\n    const [skipping, setSkipping] = useState(false)\n    const [currentTime, setCurrentTime] = useState(0)\n    const [meta, setMeta] = useState<playerMetaData>(defaultTime)\n    const [speed, setSpeed] = useLocalStorageState('ph-rrweb-player-speed', 1)\n\n    const play = () => {\n        setPlaying(true)\n        replayer.current!.play(currentTime)\n    }\n\n    const pause = () => {\n        setPlaying(false)\n        replayer.current!.pause()\n    }\n\n    const togglePlayPause = () => {\n        if (!playing && currentTime >= meta.totalTime) {\n            seek(0, { forcePlay: true })\n        } else if (playing) {\n            pause()\n        } else {\n            play()\n        }\n    }\n\n    const seek = (\n        time: number,\n        { forcePlay }: { forcePlay?: boolean } = {}\n    ) => {\n        time = Math.max(Math.min(time, meta.totalTime), 0)\n        replayer.current!.play(time)\n        setCurrentTimeDebounced(time)\n        onPlayerTimeChangeDebounced(time)\n        setSkipping(false)\n        if (!playing) {\n            if (forcePlay) {\n                setPlaying(true)\n            } else {\n                replayer.current!.pause()\n            }\n        }\n    }\n\n    const setCurrentTimeDebounced = useDebouncedCallback(setCurrentTime, 10, {\n        maxWait: 100\n    }).callback\n\n    const onPlayerTimeChangeDebounced = useDebouncedCallback(\n        onPlayerTimeChange || NOOP,\n        300,\n        { maxWait: 1000 }\n    ).callback\n\n    useEffect(() => {\n        if (frame) {\n            stopTimer()\n\n            replayer.current = new Replayer(events, {\n                root: frame,\n                skipInactive: true,\n                triggerFocus: false,\n                speed\n            })\n\n            replayer.current.on('finish', pause)\n            replayer.current.on('skip-start', () => setSkipping(true))\n            replayer.current.on('skip-end', () => setSkipping(false))\n\n            replayer.current.play()\n            setPlaying(true)\n            updateTime()\n\n            if (!isBuffering) {\n                const meta = replayer.current.getMetaData()\n                setMeta(meta)\n            }\n\n            wrapper.current?.focus()\n        }\n\n        return () => {\n            stopTimer()\n            replayer.current?.pause()\n        }\n    }, [frame])\n\n    useEffect(() => {\n        if (frame && replayer.current) {\n            // Only add the events that don't already exist in replayer's context\n\n            const currentEvents =\n                replayer.current?.service.state.context.events ?? []\n            const eventsToAdd = events.slice(currentEvents.length) ?? []\n            eventsToAdd.forEach((event) => replayer.current?.addEvent(event))\n\n            // If player stopped playing because events were buffering, resume playing\n            if (\n                !playing &&\n                currentTime >=\n                    (currentEvents.slice(-1)[0]?.timestamp ?? currentTime + 1)\n            ) {\n                replayer.current.play()\n                setPlaying(true)\n            }\n\n            if (!isBuffering) {\n                const meta = replayer.current.getMetaData()\n                setMeta(meta)\n            }\n        }\n    }, [events.length])\n\n    useEffect((): any => {\n        stopTimer()\n\n        if (playing && meta.totalTime > 0) {\n            updateTime()\n            return () => stopTimer()\n        }\n    }, [playing, meta])\n\n    useEffect(() => {\n        if (replayer.current) {\n            replayer.current.setConfig({ speed })\n        }\n    }, [speed])\n\n    const stopTimer = () => {\n        if (timer.current) {\n            cancelAnimationFrame(timer.current)\n        }\n    }\n\n    const updateTime = () => {\n        if (replayer.current) {\n            const currentTime = Math.min(\n                replayer.current.getCurrentTime(),\n                meta.totalTime\n            )\n            setCurrentTimeDebounced(currentTime)\n            onPlayerTimeChangeDebounced(currentTime)\n        }\n        timer.current = requestAnimationFrame(updateTime)\n    }\n\n    const handleKeyDown = (\n        event: React.KeyboardEvent<HTMLDivElement>\n    ): void => {\n        if (event.key === ' ') {\n            togglePlayPause()\n            event.preventDefault()\n        } else if (event.key === 'ArrowLeft') {\n            seek(currentTime - JUMP_TIME_MS)\n        } else if (event.key === 'ArrowRight') {\n            seek(currentTime + JUMP_TIME_MS)\n        } else if (event.key === 'f') {\n            toggleFullScreen()\n        } else {\n            // Playback speeds shortcuts\n            for (let i = 0; i < PLAYBACK_SPEEDS.length; i++) {\n                if (event.key === (i + 1).toString()) {\n                    setSpeed(PLAYBACK_SPEEDS[i])\n                }\n            }\n        }\n    }\n\n    const seekBack = () => {\n        seek(currentTime - JUMP_TIME_MS)\n    }\n\n    const toggleFullScreen = () => {\n        if (screenfull.isEnabled && wrapper) {\n            screenfull.toggle(wrapper.current!)\n        }\n    }\n\n    const value = useMemo(\n        () => ({\n            replayer,\n            frame,\n            setFrameRef,\n            wrapper,\n            timer,\n            skipping,\n            playing,\n            currentTime,\n            speed,\n            meta,\n            isBuffering,\n            setSkipping,\n            setPlaying,\n            setCurrentTime: setCurrentTimeDebounced,\n            onPlayerTimeChange: onPlayerTimeChangeDebounced,\n            setSpeed,\n            setMeta,\n            handleKeyDown,\n            toggleFullScreen,\n            play,\n            pause,\n            togglePlayPause,\n            seek,\n            seekBack,\n            stopTimer,\n            updateTime\n        }),\n        [\n            replayer,\n            frame,\n            setFrameRef,\n            wrapper,\n            timer,\n            skipping,\n            playing,\n            currentTime,\n            speed,\n            meta,\n            isBuffering,\n            setSkipping,\n            setPlaying,\n            setCurrentTimeDebounced,\n            onPlayerTimeChangeDebounced,\n            setSpeed,\n            setMeta,\n            handleKeyDown,\n            toggleFullScreen,\n            play,\n            pause,\n            togglePlayPause,\n            seek,\n            seekBack,\n            stopTimer,\n            updateTime\n        ]\n    )\n\n    useImperativeHandle(ref, () => ({ replayer, seek }))\n\n    return (\n        <PlayerContext.Provider value={value}>\n            <div\n                ref={wrapper}\n                onKeyDown={handleKeyDown}\n                tabIndex={0}\n                style={{ height: '100%', width: '100%' }}\n            >\n                {children}\n            </div>\n        </PlayerContext.Provider>\n    )\n})\n","// Base icons from https://github.com/ant-design/ant-design\n\nimport React from 'react'\n\nfunction BaseIcon({\n    children,\n    onClick = () => {},\n    className = ''\n}: {\n    children: JSX.Element\n    onClick?: () => void\n    className?: string\n}): JSX.Element {\n    return (\n        <span\n            onClick={onClick}\n            className={className || 'ph-rrweb-controller-icon'}\n        >\n            {children}\n        </span>\n    )\n}\n\nexport function IconSeekBack({\n    onClick,\n    className = ''\n}: {\n    onClick: () => void\n    className?: string\n}): JSX.Element {\n    // TODO: Allow the number of seconds to be set dynamically\n    return (\n        <BaseIcon onClick={onClick} className={className}>\n            <svg\n                width='32'\n                height='32'\n                viewBox='0 0 32 32'\n                fill='none'\n                xmlns='http://www.w3.org/2000/svg'\n            >\n                <path\n                    d='M26.6812 6.91244H11.2101V4.28466C11.2101 4.04674 10.9312 3.91535 10.7428 4.06094L5.59783 8.03812C5.56318 8.0647 5.53516 8.09865 5.5159 8.13741C5.49663 8.17617 5.48661 8.21872 5.48661 8.26184C5.48661 8.30496 5.49663 8.34751 5.5159 8.38627C5.53516 8.42503 5.56318 8.45898 5.59783 8.48556L10.7428 12.4627C10.9312 12.6083 11.2101 12.4769 11.2101 12.239V9.61124H26.2464V26.3012H4.28986C4.13043 26.3012 4 26.429 4 26.5853V28.7159C4 28.8722 4.13043 29 4.28986 29H26.6812C27.9601 29 29 27.9808 29 26.7273V9.18511C29 7.93159 27.9601 6.91244 26.6812 6.91244Z'\n                    fill='currentColor'\n                />\n                <path\n                    d='M17.0234 20.082C17.0234 20.5697 17.1488 20.9479 17.3994 21.2168C17.6546 21.4857 18.0055 21.6201 18.4521 21.6201C18.8988 21.6201 19.2474 21.4857 19.498 21.2168C19.7533 20.9479 19.8809 20.5697 19.8809 20.082C19.8809 19.5762 19.751 19.1934 19.4912 18.9336C19.236 18.6693 18.8896 18.5371 18.4521 18.5371C18.0146 18.5371 17.666 18.6693 17.4062 18.9336C17.151 19.1934 17.0234 19.5762 17.0234 20.082ZM15 20.2119C15 19.6559 15.1253 19.1523 15.376 18.7012C15.6312 18.25 16.0026 17.9105 16.4902 17.6826C16.0117 17.3636 15.6995 17.0195 15.5537 16.6504C15.4124 16.2767 15.3418 15.9281 15.3418 15.6045C15.3418 14.8844 15.613 14.2715 16.1553 13.7656C16.6976 13.2552 17.4632 13 18.4521 13C19.4411 13 20.2067 13.2552 20.749 13.7656C21.2913 14.2715 21.5625 14.8844 21.5625 15.6045C21.5625 15.9281 21.4896 16.2767 21.3438 16.6504C21.2025 17.0195 20.8926 17.3408 20.4141 17.6143C20.9017 17.8877 21.2686 18.25 21.5146 18.7012C21.7607 19.1523 21.8838 19.6559 21.8838 20.2119C21.8838 21.0459 21.5739 21.7568 20.9541 22.3447C20.3389 22.9281 19.4775 23.2197 18.3701 23.2197C17.2627 23.2197 16.4242 22.9281 15.8545 22.3447C15.2848 21.7568 15 21.0459 15 20.2119ZM17.2012 15.8232C17.2012 16.1833 17.3105 16.4772 17.5293 16.7051C17.7526 16.9329 18.0602 17.0469 18.4521 17.0469C18.8486 17.0469 19.154 16.9329 19.3682 16.7051C19.5869 16.4772 19.6963 16.1833 19.6963 15.8232C19.6963 15.4313 19.5869 15.126 19.3682 14.9072C19.154 14.6839 18.8486 14.5723 18.4521 14.5723C18.0602 14.5723 17.7526 14.6839 17.5293 14.9072C17.3105 15.126 17.2012 15.4313 17.2012 15.8232Z'\n                    fill='currentColor'\n                />\n            </svg>\n        </BaseIcon>\n    )\n}\n\nexport function IconPlay({\n    onClick,\n    className = ''\n}: {\n    onClick?: () => void\n    className?: string\n}): JSX.Element {\n    return (\n        <BaseIcon onClick={onClick} className={className}>\n            <svg\n                width='32'\n                height='32'\n                viewBox='0 0 32 32'\n                fill='none'\n                xmlns='http://www.w3.org/2000/svg'\n            >\n                <path\n                    d='M9.36139 28.8202L24.1954 17.1629C24.2945 17.0841 24.3746 16.984 24.4297 16.87C24.4847 16.756 24.5133 16.6311 24.5133 16.5045C24.5133 16.3779 24.4847 16.2529 24.4297 16.1389C24.3746 16.0249 24.2945 15.9248 24.1954 15.8461L9.36139 4.18126C8.81088 3.74978 8 4.13663 8 4.83592V28.1581C8 28.8574 8.81088 29.2517 9.36139 28.8202Z'\n                    fill='currentColor'\n                />\n            </svg>\n        </BaseIcon>\n    )\n}\n\nexport function IconPause({\n    onClick,\n    className = ''\n}: {\n    onClick?: () => void\n    className?: string\n}): JSX.Element {\n    return (\n        <BaseIcon onClick={onClick} className={className}>\n            <svg\n                width='32'\n                height='32'\n                viewBox='0 0 32 32'\n                fill='none'\n                xmlns='http://www.w3.org/2000/svg'\n            >\n                <path\n                    d='M9.5 5.5H12V26.5H9.5V5.5ZM22.25 5.5H20.25C20.1125 5.5 20 5.6125 20 5.75V26.25C20 26.3875 20.1125 26.5 20.25 26.5H22.25C22.3875 26.5 22.5 26.3875 22.5 26.25V5.75C22.5 5.6125 22.3875 5.5 22.25 5.5Z'\n                    fill='currentColor'\n                />\n            </svg>\n        </BaseIcon>\n    )\n}\n\nexport function IconFullscreen({\n    onClick,\n    className = ''\n}: {\n    onClick: () => void\n    className?: string\n}): JSX.Element {\n    return (\n        <BaseIcon onClick={onClick} className={className}>\n            <svg\n                width='32'\n                height='32'\n                viewBox='0 0 32 32'\n                fill='none'\n                xmlns='http://www.w3.org/2000/svg'\n            >\n                <path\n                    d='M9.06247 7.38754L10.4343 6.01567C10.4674 5.98246 10.4905 5.94064 10.5009 5.89498C10.5114 5.84931 10.5088 5.80163 10.4935 5.75735C10.4782 5.71307 10.4508 5.67397 10.4143 5.64451C10.3779 5.61504 10.334 5.59639 10.2875 5.59067L5.28122 5.00004C5.12184 4.98129 4.98434 5.11567 5.00309 5.27817L5.59372 10.2844C5.61872 10.4907 5.87184 10.5782 6.01872 10.4313L7.38434 9.06567L11.5625 13.2407C11.6593 13.3375 11.8187 13.3375 11.9156 13.2407L13.2406 11.9188C13.3375 11.8219 13.3375 11.6625 13.2406 11.5657L9.06247 7.38754ZM20.0843 13.2407C20.1812 13.3375 20.3406 13.3375 20.4375 13.2407L24.6156 9.06567L25.9812 10.4313C26.0144 10.4643 26.0562 10.4874 26.1019 10.4979C26.1476 10.5083 26.1953 10.5057 26.2395 10.4904C26.2838 10.4751 26.3229 10.4477 26.3524 10.4113C26.3818 10.3749 26.4005 10.3309 26.4062 10.2844L26.9968 5.28129C27.0156 5.12192 26.8812 4.98442 26.7187 5.00317L21.7125 5.59379C21.5062 5.61879 21.4187 5.87192 21.5656 6.01879L22.9375 7.39067L18.7593 11.5625C18.7128 11.6095 18.6867 11.673 18.6867 11.7391C18.6867 11.8052 18.7128 11.8687 18.7593 11.9157L20.0843 13.2407V13.2407ZM26.4062 21.7157C26.3812 21.5094 26.1281 21.4219 25.9812 21.5688L24.6156 22.9344L20.4375 18.7594C20.3905 18.7129 20.327 18.6868 20.2609 18.6868C20.1948 18.6868 20.1313 18.7129 20.0843 18.7594L18.7593 20.0813C18.7128 20.1283 18.6867 20.1917 18.6867 20.2579C18.6867 20.324 18.7128 20.3874 18.7593 20.4344L22.9375 24.6125L21.5656 25.9844C21.5325 26.0176 21.5095 26.0594 21.499 26.1051C21.4886 26.1508 21.4911 26.1985 21.5064 26.2427C21.5217 26.287 21.5492 26.3261 21.5856 26.3556C21.622 26.385 21.666 26.4037 21.7125 26.4094L26.7187 27C26.8781 27.0188 27.0156 26.8844 26.9968 26.7219L26.4062 21.7157ZM11.9156 18.7594C11.8686 18.7129 11.8052 18.6868 11.739 18.6868C11.6729 18.6868 11.6095 18.7129 11.5625 18.7594L7.38434 22.9344L6.01872 21.5688C5.98551 21.5357 5.9437 21.5127 5.89803 21.5022C5.85236 21.4918 5.80468 21.4943 5.7604 21.5096C5.71612 21.5249 5.67702 21.5524 5.64756 21.5888C5.61809 21.6252 5.59944 21.6692 5.59372 21.7157L5.00309 26.7188C4.98434 26.8782 5.11872 27.0157 5.28122 26.9969L10.2875 26.4063C10.4937 26.3813 10.5812 26.1282 10.4343 25.9813L9.06247 24.6125L13.2406 20.4375C13.3375 20.3407 13.3375 20.1813 13.2406 20.0844L11.9156 18.7594V18.7594Z'\n                    fill='currentColor'\n                />\n            </svg>\n        </BaseIcon>\n    )\n}\n\nexport function IconStepForward({\n    onClick,\n    className = ''\n}: {\n    onClick: () => void\n    className?: string\n}): JSX.Element {\n    return (\n        <BaseIcon onClick={onClick} className={className}>\n            <svg\n                width='32'\n                height='32'\n                viewBox='0 0 32 32'\n                fill='none'\n                xmlns='http://www.w3.org/2000/svg'\n            >\n                <path\n                    d='M21.1375 16.5297L9.1625 25.9366C8.71719 26.2866 8.0625 25.9709 8.0625 25.4069V6.59281C8.0625 6.02875 8.71719 5.71344 9.1625 6.06344L21.1375 15.4703C21.2179 15.5333 21.2828 15.6137 21.3275 15.7054C21.3722 15.7972 21.3955 15.8979 21.3955 16C21.3955 16.1021 21.3722 16.2028 21.3275 16.2946C21.2828 16.3864 21.2179 16.4667 21.1375 16.5297V16.5297ZM21.6875 27H23.6875C23.7538 27 23.8174 26.9737 23.8643 26.9268C23.9112 26.8799 23.9375 26.8163 23.9375 26.75V5.25C23.9375 5.1837 23.9112 5.12011 23.8643 5.07322C23.8174 5.02634 23.7538 5 23.6875 5H21.6875C21.6212 5 21.5576 5.02634 21.5107 5.07322C21.4638 5.12011 21.4375 5.1837 21.4375 5.25V26.75C21.4375 26.8163 21.4638 26.8799 21.5107 26.9268C21.5576 26.9737 21.6212 27 21.6875 27Z'\n                    fill='currentColor'\n                />\n            </svg>\n        </BaseIcon>\n    )\n}\n\nexport function IconStepBackward({\n    onClick,\n    className = ''\n}: {\n    onClick: () => void\n    className?: string\n}): JSX.Element {\n    return (\n        <BaseIcon onClick={onClick} className={className}>\n            <svg\n                width='32'\n                height='32'\n                viewBox='0 0 32 32'\n                fill='none'\n                xmlns='http://www.w3.org/2000/svg'\n            >\n                <path\n                    d='M10.8625 16.5297L22.8375 25.9366C23.2828 26.2866 23.9375 25.9709 23.9375 25.4069V6.59281C23.9375 6.02875 23.2828 5.71344 22.8375 6.06344L10.8625 15.4703C10.7821 15.5333 10.7172 15.6137 10.6725 15.7054C10.6278 15.7972 10.6045 15.8979 10.6045 16C10.6045 16.1021 10.6278 16.2028 10.6725 16.2946C10.7172 16.3864 10.7821 16.4667 10.8625 16.5297V16.5297ZM10.3125 27H8.3125C8.2462 27 8.18261 26.9737 8.13572 26.9268C8.08884 26.8799 8.0625 26.8163 8.0625 26.75V5.25C8.0625 5.1837 8.08884 5.12011 8.13572 5.07322C8.18261 5.02634 8.2462 5 8.3125 5H10.3125C10.3788 5 10.4424 5.02634 10.4893 5.07322C10.5362 5.12011 10.5625 5.1837 10.5625 5.25V26.75C10.5625 26.8163 10.5362 26.8799 10.4893 26.9268C10.4424 26.9737 10.3788 27 10.3125 27Z'\n                    fill='currentColor'\n                />\n            </svg>\n        </BaseIcon>\n    )\n}\n","import React, { useEffect, useState } from 'react'\nimport { IconPlay, IconPause } from './icons'\nimport CSSTransition from 'react-transition-group/CSSTransition'\n\ninterface Props {\n    playing: boolean\n}\n\nexport function PlayPauseOverlay({ playing }: Props): JSX.Element | null {\n    const [show, setShow] = useState(false)\n    const [changeCount, setChangeCount] = useState(0)\n\n    useEffect(() => {\n        setShow(true)\n        setChangeCount(changeCount + 1)\n    }, [playing])\n\n    return (\n        <CSSTransition\n            in={changeCount > 1 && show}\n            timeout={400}\n            classNames='ph-rrweb-play-pause-overlay'\n            onEntered={() => setShow(false)}\n        >\n            <div className='ph-rrweb-play-pause-overlay'>\n                {playing ? (\n                    <IconPlay className='ph-rrweb-play-pause-overlay-icon' />\n                ) : (\n                    <IconPause className='ph-rrweb-play-pause-overlay-icon' />\n                )}\n            </div>\n        </CSSTransition>\n    )\n}\n","import React, { useContext, useEffect, useRef } from 'react'\nimport { viewportResizeDimension } from 'rrweb/typings/types'\nimport { PlayPauseOverlay } from './PlayPauseOverlay'\nimport { PlayerContext } from './PlayerContext'\n\nexport function PlayerFrame() {\n    const replayDimensionRef = useRef<viewportResizeDimension>()\n\n    const context = useContext(PlayerContext)\n\n    if (!context) {\n        // PlayerController must be wrapped by a Provider\n        return null\n    }\n\n    const {\n        playing,\n        togglePlayPause,\n        replayer,\n        frame,\n        skipping,\n        setFrameRef\n    } = context\n\n    useEffect(() => {\n        if (!replayer.current) {\n            return\n        }\n\n        replayer.current!.on('resize', updatePlayerDimensions)\n        window.addEventListener('resize', windowResize)\n\n        return () => window.removeEventListener('resize', windowResize)\n    }, [replayer.current])\n\n    const windowResize = () => {\n        updatePlayerDimensions(replayDimensionRef.current)\n    }\n\n    // :TRICKY: Scale down the iframe and try to position it vertically\n    const updatePlayerDimensions = (\n        replayDimensions: viewportResizeDimension | undefined\n    ) => {\n        if (!replayDimensions || !frame) {\n            return\n        }\n\n        replayDimensionRef.current = replayDimensions\n        const { width, height } = frame.parentElement!.getBoundingClientRect()\n\n        const scale = Math.min(\n            width / replayDimensions.width,\n            height / replayDimensions.height,\n            1\n        )\n\n        replayer.current!.wrapper.style.transform = `scale(${scale})`\n        frame.style.paddingLeft = `${\n            (width - replayDimensions.width * scale) / 2\n        }px`\n        frame.style.paddingTop = `${\n            (height - replayDimensions.height * scale) / 2\n        }px`\n    }\n\n    return (\n        <div className='ph-rrweb-player' onClick={togglePlayPause}>\n            <div ref={(ref) => setFrameRef(ref)} />\n            <div className='ph-rrweb-overlay'>\n                {skipping && (\n                    <div className='ph-rrweb-skipping'>\n                        Skipping inactivity...\n                    </div>\n                )}\n\n                <PlayPauseOverlay playing={playing} />\n            </div>\n        </div>\n    )\n}\n","const SECOND = 1000\nconst MINUTE = 60 * SECOND\nconst HOUR = 60 * MINUTE\n\nfunction padZero(num: number, len = 2): string {\n    let str = `${num}`\n    const threshold = Math.pow(10, len - 1)\n    if (num < threshold) {\n        while (String(threshold).length > str.length) {\n            str = '0' + num\n        }\n    }\n    return str\n}\n\nexport function formatTime(ms: number): string {\n    if (ms <= 0) {\n        return '00:00'\n    }\n    const hour = Math.floor(ms / HOUR)\n    ms = ms % HOUR\n    const minute = Math.floor(ms / MINUTE)\n    ms = ms % MINUTE\n    const second = Math.floor(ms / SECOND)\n    if (hour) {\n        return `${padZero(hour)}:${padZero(minute)}:${padZero(second)}`\n    }\n    return `${padZero(minute)}:${padZero(second)}`\n}\n","import React, { useContext } from 'react'\nimport { PlayerContext } from './PlayerContext'\nimport Tooltip from 'rc-tooltip'\nimport { IconFullscreen, IconPause, IconPlay, IconSeekBack } from './icons'\nimport { formatTime } from './time'\nimport Slider from 'rc-slider/lib/Slider'\nimport screenfull from 'screenfull'\n\nconst JUMP_TIME_MS = 8_000\nconst PLAYBACK_SPEEDS = [0.5, 1, 2, 4, 8, 16]\n\nexport function PlayerController(): JSX.Element | null {\n    const context = useContext(PlayerContext)\n    if (!context) {\n        // PlayerController must be wrapped by a Provider\n        return null\n    }\n\n    const {\n        speed,\n        meta,\n        setSpeed,\n        playing,\n        togglePlayPause,\n        seek,\n        seekBack,\n        currentTime,\n        isBuffering,\n        toggleFullScreen\n    } = context\n\n    return (\n        <div className='ph-rrweb-bottom'>\n            <div className='ph-rrweb-controller'>\n                <div>\n                    <Tooltip\n                        placement='top'\n                        overlayInnerStyle={{ minHeight: 'auto' }}\n                        overlay='Play/pause (space)'\n                    >\n                        <span>\n                            {playing ? (\n                                <IconPause\n                                    onClick={togglePlayPause}\n                                    className='ph-rrweb-controller-icon ph-rrweb-controller-icon-play-pause'\n                                />\n                            ) : (\n                                <IconPlay\n                                    onClick={togglePlayPause}\n                                    className='ph-rrweb-controller-icon ph-rrweb-controller-icon-play-pause'\n                                />\n                            )}\n                        </span>\n                    </Tooltip>\n                    <Tooltip\n                        placement='top'\n                        overlayInnerStyle={{ minHeight: 'auto' }}\n                        overlay={`Back ${JUMP_TIME_MS / 1000}s (← left arrow)`}\n                    >\n                        <span>\n                            <IconSeekBack onClick={seekBack} />\n                        </span>\n                    </Tooltip>\n                    <span className='ph-rrweb-timestamp'>\n                        {formatTime(currentTime)} /{' '}\n                        {isBuffering ? '--:--:--' : formatTime(meta.totalTime)}\n                    </span>\n                </div>\n                <div className='ph-rrweb-progress'>\n                    <Slider\n                        value={currentTime}\n                        min={0}\n                        max={meta.totalTime}\n                        step={0.01}\n                        onChange={seek}\n                    />\n                </div>\n                <div style={{ justifyContent: 'flex-end' }}>\n                    {PLAYBACK_SPEEDS.map((speedToggle, index) => (\n                        <React.Fragment key={speedToggle}>\n                            <Tooltip\n                                placement='top'\n                                overlayInnerStyle={{ minHeight: 'auto' }}\n                                overlay={`${speedToggle}x speed (${index + 1})`}\n                            >\n                                <span\n                                    className='ph-rrweb-speed-toggle'\n                                    style={{\n                                        fontWeight:\n                                            speedToggle === speed\n                                                ? 'bold'\n                                                : 'normal'\n                                    }}\n                                    onClick={() => setSpeed(speedToggle)}\n                                >\n                                    {speedToggle}x\n                                </span>\n                            </Tooltip>\n                        </React.Fragment>\n                    ))}\n                    {screenfull.isEnabled && (\n                        <Tooltip\n                            placement='top'\n                            overlayInnerStyle={{ minHeight: 'auto' }}\n                            overlay='Full screen (f)'\n                        >\n                            <span>\n                                <IconFullscreen onClick={toggleFullScreen} />\n                            </span>\n                        </Tooltip>\n                    )}\n                </div>\n            </div>\n        </div>\n    )\n}\n","import { eventWithTime } from 'rrweb/typings/types'\n\nexport interface Metadata {\n    playerTime: number\n}\n\nexport interface PageMetadata extends Metadata {\n    href: string\n}\n\nexport interface RecordingMetadata extends Metadata {\n    resolution: string\n    width: number\n    height: number\n}\n\nexport interface LibCustomEvent {\n    type: 5\n    data: {\n        tag: string\n        payload: any\n    }\n}\n\nexport class EventIndex {\n    events: eventWithTime[]\n    baseTime: number\n    _filterByCaches: { [key: string]: any[] }\n\n    constructor(events: eventWithTime[]) {\n        this.events = events\n        this.baseTime = events.length > 0 ? events[0].timestamp : 0\n        this._filterByCaches = {}\n    }\n\n    getDuration = (): number =>\n        this.events.length > 0 ? this.events[this.events.length - 1].timestamp - this.events[0].timestamp : 0\n\n    getPageMetadata = (\n        playerTime: number\n    ): [PageMetadata, number] | [null, -1] =>\n        findCurrent(playerTime, this.pageChangeEvents())\n\n    getRecordingMetadata = (\n        playerTime: number\n    ): [RecordingMetadata, number] | [null, -1] =>\n        findCurrent(playerTime, this.recordingMetadata())\n\n    pageChangeEvents = (): PageMetadata[] =>\n        this._filterBy('href', (event) => {\n            if ('href' in event.data) {\n                return {\n                    href: (event.data as { href: string }).href,\n                    playerTime: event.timestamp - this.baseTime\n                }\n            }\n            if (\n                event.type === 5 &&\n                (event as LibCustomEvent).data.tag === '$pageview'\n            ) {\n                return {\n                    href: (event as LibCustomEvent).data.payload.href,\n                    playerTime: event.timestamp - this.baseTime\n                }\n            }\n\n            return null\n        })\n\n    recordingMetadata = (): RecordingMetadata[] =>\n        this._filterBy('resolution', (event) => {\n            if ('width' in event.data && 'height' in event.data) {\n                const { width, height } = event.data\n                return {\n                    resolution: `${width} x ${height}`,\n                    height: height,\n                    width: width,\n                    playerTime: event.timestamp - this.baseTime\n                }\n            }\n            return null\n        })\n\n    _filterBy = <T extends Record<string, V>, V>(\n        dataKey: string,\n        transformer: (e: eventWithTime) => T | null\n    ): T[] => {\n        if (!this._filterByCaches[dataKey]) {\n            let lastValueKey: V | undefined\n\n            this._filterByCaches[dataKey] = this.events\n                .map(transformer)\n                .filter((value: T | null) => !!value)\n                .filter((value: T) => {\n                    if (value[dataKey] !== lastValueKey) {\n                        lastValueKey = value[dataKey]\n                        return true\n                    }\n                    return false\n                })\n        }\n        return this._filterByCaches[dataKey] as T[]\n    }\n}\n\nexport const findCurrent = <T extends Metadata>(\n    playerTime: number,\n    events: T[]\n): [T, number] | [null, -1] => {\n    let index = events.findIndex((event) => event.playerTime > playerTime)\n\n    if (index === 0) {\n        return [events[0], 0]\n    } else if (index === -1) {\n        index = events.length - 1\n        return [events[index], index]\n    }\n    return [events[index - 1], index - 1]\n}\n","import React, { useEffect, useMemo, useRef, useState } from 'react'\n\nimport { EventIndex, formatTime, PlayerRef, PlayerContextProvider, PlayerController, PlayerFrame } from '@posthog/react-rrweb-player'\nimport useLocalStorageState from 'use-local-storage-state'\nimport Select from 'react-select'\nimport { eventWithTime } from 'rrweb/typings/types'\n\nimport '@posthog/react-rrweb-player/dist/index.css'\nimport 'rc-tooltip/assets/bootstrap.css'\n\nconst makeOption = (label: string) => ({ value: window.location.pathname + label, label })\n\nconst RECORDINGS = [\n  makeOption('docs.json'),\n  makeOption('local-docs.json'),\n  makeOption('homepage.json'),\n  makeOption('mobile-homepage.json'),\n  makeOption('wide-layout.json'),\n  makeOption('with-pageviews.json')\n]\n\nconst App = () => {\n  const [events, setEvents] = useState<eventWithTime[]>([])\n  const [recording, setRecording] = useLocalStorageState('recording', RECORDINGS[0])\n  const [activeRecording, setActiveRecording] = useState(recording)\n  const [playerTime, setCurrentPlayerTime] = useState(0)\n\n  const playerRef = useRef<PlayerRef>(null)\n\n  useEffect(() => {\n      async function fetchRecording() {\n        const response = await fetch(recording.value)\n        const { result } = await response.json()\n\n        setEvents(result)\n        setActiveRecording(recording)\n    }\n\n    fetchRecording()\n  }, [recording])\n\n  const eventIndex: EventIndex = useMemo(() => new EventIndex(events), [events])\n  const [pageEvent, atPageIndex] = useMemo(() => eventIndex.getPageMetadata(playerTime), [eventIndex, playerTime])\n  const [recordingMetadata] = useMemo(() => eventIndex.getRecordingMetadata(playerTime), [eventIndex, playerTime])\n  const pageVisitEvents = useMemo(() => eventIndex.pageChangeEvents(), [eventIndex])\n\n  return (\n    <div>\n      <div style={{ height: '80vh', width: '90vw' }}>\n        {events.length > 0 && (\n            <PlayerContextProvider\n                ref={playerRef}\n                events={events}\n                key={activeRecording.value}\n                onPlayerTimeChange={setCurrentPlayerTime}\n                onNext={() => {\n                    console.log('next recording...')\n                }}\n                onPrevious={() => {\n                    console.log('previous recording...')\n                }}\n                duration={events.length > 0 ? (events.slice(-1)[0].timestamp - events[0].timestamp) : 0}\n                isBuffering={false}\n            >\n                <PlayerFrame />\n                <PlayerController />\n            </PlayerContextProvider>\n        )}\n      </div>\n\n      <div style={{ zIndex: 100, marginTop: 16, width: '300px' }}>\n        <Select\n          options={RECORDINGS}\n          value={recording}\n          onChange={(recording) => setRecording(recording as any)}\n        />\n\n        <pre>{JSON.stringify(pageEvent)}</pre>\n        <pre>{JSON.stringify(recordingMetadata)}</pre>\n      </div>\n\n      <ul style={{ width: '50vw' }}>\n        {pageVisitEvents.map((event, index) => (\n          <li key={index}>\n            <button onClick={() => playerRef.current && playerRef.current.seek(event.playerTime)}>\n               {formatTime(event.playerTime)} - Visited {event.href}\n            </button>\n            {index === atPageIndex ? ' (Active)' : null}\n          </li>\n        ))}\n      </ul>\n    </div>\n  )\n}\n\nexport default App\n","import './index.css'\n\nimport React from 'react'\nimport ReactDOM from 'react-dom'\nimport App from './App'\n\nReactDOM.render(<App />, document.getElementById('root'))\n"],"sourceRoot":""}